# ==============================
# ğŸ Dockerfile for Gift Service
# ==============================

# ğŸ§± Stage 1: Build Go binary
FROM docker.arvancloud.ir/golang:1.24.2 AS builder

WORKDIR /app

# ğŸ“š Download Go dependencies
COPY go.mod go.sum ./
RUN go mod download

# ğŸ“¥ Copy all source code
COPY . .

# âš™ï¸ Build static binary
ENV CGO_ENABLED=0 GOOS=linux GOARCH=amd64
RUN go build -o gift-service ./cmd/main.go

# ==============================
# ğŸª¶ Stage 2: Runtime image
# ==============================
FROM docker.arvancloud.ir/alpine:latest

WORKDIR /app

# ğŸ“¦ Copy compiled binary
COPY --from=builder /app/gift-service .

# ğŸ” Make executable
RUN chmod +x /app/gift-service

# ğŸŒ Expose port
EXPOSE 8082

# ğŸš€ Start service
CMD ["./gift-service"]
